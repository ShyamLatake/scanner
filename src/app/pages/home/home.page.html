<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Child Records</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="home-container">
    <!-- Search bar -->
    <div class="search-section">
      <ion-searchbar
        [(ngModel)]="searchTerm"
        (ionInput)="handleSearch($event)"
        placeholder="Search by name, ID, class..."
        animated="true"
      ></ion-searchbar>
    </div>

    <!-- Stats Card -->
    <ion-card class="stats-card">
      <ion-card-header>
        <ion-card-title>Student Records</ion-card-title>
        <ion-card-subtitle>
          {{ filteredChildren.length }} of {{ totalChildren }} students
        </ion-card-subtitle>
      </ion-card-header>
    </ion-card>

    <!-- Loading spinner -->
    @if (isLoading) {
      <div class="loading-container">
        <ion-spinner name="crescent"></ion-spinner>
        <p>Loading students...</p>
      </div>
    }

    <!-- Children List -->
    @if (!isLoading && filteredChildren.length > 0) {
      <div class="children-list">
        @for (child of filteredChildren; track child.id) {
          <div class="child-card" (click)="navigateToChild(child)">
            <div class="child-avatar">
              @if (child.profile_Image) {
                <img [src]="child.profile_Image" [alt]="getFullName(child)" />
              } @else {
                <ion-icon name="person-circle-outline"></ion-icon>
              }
            </div>
            
            <div class="child-info">
              <h2>{{ getFullName(child) }}</h2>
              <p class="student-id">ID: {{ child.student_ref_Id }}</p>
              <div class="badges">
                <span class="badge badge-primary">{{ child.standard }}</span>
                @if (child.division) {
                  <span class="badge badge-secondary">{{ child.division }}</span>
                }
              </div>
            </div>

            <ion-icon name="chevron-forward-outline" class="arrow-icon"></ion-icon>
          </div>
        }
      </div>
    }

    <!-- Empty state -->
    @if (!isLoading && filteredChildren.length === 0 && searchTerm) {
      <div class="empty-state">
        <ion-icon name="search-outline"></ion-icon>
        <h3>No results found</h3>
        <p>Try searching with different keywords</p>
      </div>
    }

    @if (!isLoading && children.length === 0) {
      <div class="empty-state">
        <ion-icon name="person-circle-outline"></ion-icon>
        <h3>No student records</h3>
        <p>No records available at the moment</p>
      </div>
    }
  </div>

  <!-- Pull to refresh -->
  <ion-refresher slot="fixed" (ionRefresh)="loadChildren($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
</ion-content>
